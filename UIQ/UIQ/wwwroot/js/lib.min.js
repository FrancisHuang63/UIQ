global=typeof global==="undefined"?{}:global;lib=typeof lib==="undefined"?{}:lib;lib.input_get=function(e){e=e||"";e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=t.exec(location.search);return n===null?"":decodeURIComponent(n[1].replace(/\+/g," "))};lib.get_parameter_string=function(e){var t=[];$.each(e,function(e,n){t.push(e+"="+encodeURIComponent(n))});return t.join("&")};lib.get_object_keys=function(e){var t=[];$.each(e,function(e){t.push(e)});return t};lib.random_color=function(){var e="0123456789ABCDEF".split("");var t="#";for(var n=0;n<6;n++){t+=e[Math.floor(Math.random()*16)]}return t};lib.data=function(e){var t=[];$.each(e,function(e,n){t.push("data-"+e+"="+n)});return t.join(" ")};lib.round=function(e,t){t=t||0;var n=Math.pow(10,t);return Math.round(e*n)/n};lib.options=function(e,t){t=t||{};t.attributes=t.attributes||{};var n="";for(var a in e){if(!e.hasOwnProperty(a)){continue}var i=e[a];var r="";$.each(t.attributes,function(e,t){r+=" "+e+'="'+i[t]+'"'});var u="";if(t.selected&&t.selected(i)){u=' selected="selected"'}var o="";if(typeof t.display==="function"){o=t.display(i)}else{o=i[t.display]}n+='<option value="'+i[t.value]+'"'+r+u+">"+o+"</option>"}return n};lib.is_https=function(){return window.location.protocol==="https:"?true:false};lib.html_encode=function(e){return $("<div/>").text(e).html()};lib.html_decode=function(e){return $("<div/>").html(e).text()};lib.async_wait=function(e){global.async=global.async||{};global.async[e]=global.async[e]||{};return{set:function(t,n){global.async[e][t]=n},done:function(){var t=true;$.each(global.async[e],function(e,n){if(!n){t=false;return false}});return t}}};lib.ajax_loading=function(){var e=0;return{show:function(){e++;$("#ajax_loading").show()},hide:function(){e--;if(e===0){$("#ajax_loading").hide()}}}}();lib.ajax_queue=function(e){e=e||{};e.method=e.method||"abort";e.name=e.name||"default";global.ajax_queue=global.ajax_queue||{};var t=global.ajax_queue[e.name]=global.ajax_queue[e.name]||{method:e.method,queue:[],xhr:null};t.queue.push(e.ajax);n();function n(){if(t.queue.length===0){return}if(t.method==="abort"&&t.xhr&&t.xhr.readystate!==4){t.xhr.abort();t.xhr=null}if(t.xhr!==null){return}a(t.queue.shift())}function a(e){var a=e.complete;e.complete=function(){if(a){a(arguments)}t.xhr=null;if(t.method!=="abort"){n()}};t.xhr=$.ajax(e)}};lib.icon=function(e,t){t='title="'+t+'"'||"";function n(e){return"<span "+t+' class="glyphicon '+e+'" aria-hidden="true"></span>'}function a(e){return"<i "+t+' class="fa '+e+'"></i>'}if(e.indexOf("glyphicon-")>-1){return n(e)}else if(e.indexOf("fa-")>-1){return a(e)}else{return""}};lib.parse_datetime=function(e){var t;if(e){t=new Date(e)}else{t=new Date}return{year:t.getFullYear(),month:t.getMonth()+1,day:t.getDate(),hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()}};lib.insert_object_after_keys=function(e,t){var n={};for(var a in e){if(e.hasOwnProperty(a)){n[a]=e[a];if(typeof t[a]!=="undefined"){for(var i in t[a]){if(t[a].hasOwnProperty(i)){n[i]=t[a][i]}}}}}return n};lib.get_zero_datetime=function(e){var t=/^(\d*)(.)(\d*)?(.)?(\d*)?(.)?(\d*)?(.)?(\d*)?(.)?(\d*)?$/g;var n=t.exec(e);var a="";$.each(n,function(e,t){if(e===0){return true}if(t&&e%2&&t.length<2){n[e]="0"+n[e]}if(t){a+=n[e]}});return a};$.fn.outer_html=function(){return $("<div>").append($(this).clone()).html()};$.fn.press_enter=function(e){$(this).keypress(function(t){if(t.which===13){t.preventDefault();if(e){e()}}})};lib.time_helper=function(){var e=this;var t=null;var n=null;e.timestamp={minutes:1e3*60,hours:1e3*60*60,days:1e3*60*60*24};var a=new Date;e.set_datetime=function(e){a=e};e.near_timestamp=null;e.get_near_hour_datetime=function(n){var i=null;var r=null;$.each(n,function(e,t){var n=parseInt(a.format("HH"))-parseInt(t);if(r===null||n>=0&&n<r){r=n;i=t}});var u=a.format("yyyy/mm/dd "+i+":00:00");t=new Date(u);e.near_timestamp=t.getTime();return u};e.create_timestamp_list_by_hours=function(n,a){var i=new Date(t.getTime()+n*e.timestamp.hours);return e.create_timestamp_list(i,a)};e.create_timestamp_list=function(a,i){var r=t.getTime();var u=a.getTime();n=[];if(r<=u){for(var o=r;o<=u;o+=i*e.timestamp.hours){n.push(o)}}else{for(var o=r;o>=u;o-=i*e.timestamp.hours){n.push(o)}n.reverse()}return n};e.create_date_list_by_month=function(e,a){var i={1:[1],2:[1,15],5:[1,7,14,21,28]};var r=t.getTime();var u=e.getTime();n=[];if(r<=u){var o=t;while(o.getTime()<=u){$.each(i[a],function(e,t){o=new Date(o.getFullYear(),o.getMonth(),t);if(o.getTime()>=r&&o.getTime()<=u){n.push(o.getTime())}});o=new Date(o.getFullYear(),o.getMonth()+1,1)}}else{var l=$.extend([],i[a]).reverse();var o=t;while(o.getTime()>=u){$.each(l,function(e,t){o=new Date(o.getFullYear(),o.getMonth(),t);if(o.getTime()<=r&&o.getTime()>=u){n.push(o.getTime())}});o=new Date(o.getFullYear(),o.getMonth(),0)}n.reverse()}return n};e.get_timestamp_list=function(){return n};e.set_timestamp_list=function(e){n=e};e.get_date_object_list=function(){var e=[];$.each(n,function(t,n){e.push(new Date(n))});return e};e.get_datetime_in_format=function(e){var t=[];$.each(n,function(n,a){t.push(new Date(a).format(e))});return t};e.get_data_map=function(e,t){t=t||{};t.params=t.params||[];t.missing_values=t.missing_values||[];t.round=t.round||{};var a="";if(e.length){var i=e[0].time.length;var r={10:" 00:00:00",13:":00:00",16:":00",19:""};a=r[i]}var u={};$.each(e,function(e,t){t.time=t.time.replace(/-/g,"/");t.time+=a;u[new Date(t.time).getTime()]=t});$.each(n,function(e,n){if(!u[n]){u[n]={}}$.each(t.params,function(e,a){if(typeof u[n][a]==="undefined"||t.missing_values.indexOf(u[n][a])!==-1){u[n][a]=null}});$.each(t.round,function(e,t){if(u[n][e]!==null){u[n][e]=lib.round(u[n][e],t)}})});return u}};